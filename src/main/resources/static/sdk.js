"use strict";
let section42 = {comment : `<div class="section42-output-comment"><b>{{name}}</b><p>{{comment}}</p><hr></div>`, comments: `<div><label for="section42-input-name">Name</label><input type="text" id="section42-input-name" style="width: 100%;padding: 5px;"><label for="section42-input-comment">Comment</label><textarea name="" id="section42-input-comment" style="width: 100%;padding: 5px;" rows="5"></textarea><br><br><button type="button" id="section42-input-submit">Submit</button></div><hr>Comments<hr><div>{{comments}}</div>`, container : "", baseUrl : "https://section42.herokuapp.com/api/", location : "", commentsList: [], submitButton: null, nameInput: document.getElementById("section42-input-name"), commentInput: document.getElementById("section42-input-comment"), addComment (comment){this.commentsList.push(comment);this.insertToComments(this.commentsList)}, validate (location){let end = location.indexOf("?");if (end !== -1){location = location.substr(0, location.indexOf("?"));}location = location.split("/").join("|");location = location.split(".").join("-");return location}, compileComment (name, comment){let g = this.comment;g = g.replace("{{name}}", name);g = g.replace("{{comment}}", comment);return g;}, updateComments (comments){let g = this.comments;let j = "";comments.reverse();comments.forEach(c => {j += this.compileComment(c.username, c.comment)});return g.replace("{{comments}}", j)}, insertToComments (comments) {this.container.innerHTML = this.updateComments(comments);this.submitButton = document.getElementById("section42-input-submit");this.location = this.validate(window.location.href);let self = this;this.submitButton.onclick = function(e){let name = document.getElementById("section42-input-name").value;let comment = document.getElementById("section42-input-comment").value;if (name === ""){alert("name is Empty");return}if (comment === ""){alert ("comment is Empty");return}fetch(self.baseUrl + self.location, {headers: { "Content-Type": "application/json; charset=utf-8" }, method: 'POST', body: JSON.stringify({name: name, comment: comment,})}).then(res => {self.addComment(res);})}}, start : function (containerId) {this.location = this.validate(window.location.href);this.container = document.getElementById(containerId);fetch(this.baseUrl + this.location).then(res => res.json()).then(res => {this.insertToComments(res);this.commentsList = res;})},};section42.start("section42-comments");
